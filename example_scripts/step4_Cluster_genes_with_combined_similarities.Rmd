---
title: 'Step4: Cluster with combined similarities'
author: "Yiqun Wang"
output: github_document
---
In this example, we will cluster the notochord-enriched genes (identified in Step1) based on their expression similarities (calculated in Step2) as well as their functional similarities (calculated in Step3). 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load previously calculated expression and functional similarities
```{r}
## Expression similarity scores:
exp_sim = readRDS("../example_results/exp_similarities.rds")
exp_sim=exp_sim$noto
print(dimnames(exp_sim)[[3]])
## Functional similarity scores:
anno_sim = readRDS("../example_results/notochord_functional_similarities.RDS")
print(dimnames(anno_sim)[[3]])
```

## Integrate expression and functional similarities
We can calculate the integrated score for each expression and functional similarity pair, e.g. cos_dist and STRING, or jsdiv and string_ExpTxt+GO+Reactome+Interpro. We will try different expression-function combinations and different integration methods and compare the clustering results derived from them. 

### 1. Expression OR function: S = 1-(1-Se)(1-Sa). Integrated score will be high if either expression or functional similarity is high. For instance, a high expression similarity combined with a low functional similarity will still give a high score. 
```{r}

```

### 2. Expression AND function: S = Se*Sa. Integrated score will be high if both expression and functional similarities are high.
```{r}

```

### 3. Expression + function: S = Se + Sa.
```{r}

```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
